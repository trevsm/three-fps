{"version":3,"sources":["terrain/ground/height.png","terrain/ground/normal.png","terrain/ground/color.png","lighting/Lighting.js","terrain/ground/Ground.js","player/Player.js","player/PlayerControls.js","player/hud/Stats.js","App.js","index.js"],"names":["module","exports","Lighting","distance","sunPosition","inclination","azimuth","intensity","castShadow","position","shadow-mapSize-width","shadow-mapSize-height","shadow-camera-far","shadow-camera-left","shadow-camera-right","shadow-camera-top","shadow-camera-bottom","Ground","props","usePlane","rotation","Math","PI","args","ref","H","useLoader","THREE","Height","N","Normal","C","Color","attach","normalMap","displacementMap","map","color","Player","useSphere","mass","type","api","velocity","useRef","direction","frontVector","sideVector","camEuler","useState","forward","backward","left","right","jump","run","movement","setMovement","keys","KeyW","KeyS","KeyA","KeyD","Space","ShiftLeft","moveFieldByKey","key","useEffect","handleKeyDown","e","m","code","handleKeyUp","document","addEventListener","removeEventListener","usePlayerControls","camera","useThree","calculateVelocity","set","FinalSpeed","SPEED","subVectors","normalize","multiplyScalar","applyEuler","current","v","x","z","PLAYER_HEIGHT","subscribe","useFrame","pos","y","moveCamera","Stats","showPanel","className","parent","StatsImpl","stats","node","body","appendChild","dom","classList","add","begin","addEffect","end","addAfterEffect","removeChild","App","shadowMap","gl","alpha","fov","gravity","fallback","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.147bb4e7.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/height.7b7e172f.png\";","module.exports = __webpack_public_path__ + \"static/media/normal.a90df424.png\";","module.exports = __webpack_public_path__ + \"static/media/color.b261a21e.png\";","import React from 'react'\r\nimport { Sky } from '@react-three/drei'\r\n\r\nexport const Lighting = () => {\r\n  return (\r\n    <>\r\n      <Sky\r\n        distance={450000}\r\n        sunPosition={[1, 1, 0]}\r\n        inclination={0}\r\n        azimuth={0.25}\r\n      />\r\n      <ambientLight intensity={0.4} />\r\n      <directionalLight\r\n        castShadow\r\n        position={[2.5, 8, 5]}\r\n        intensity={1.5}\r\n        shadow-mapSize-width={1024}\r\n        shadow-mapSize-height={1024}\r\n        shadow-camera-far={50}\r\n        shadow-camera-left={-10}\r\n        shadow-camera-right={10}\r\n        shadow-camera-top={10}\r\n        shadow-camera-bottom={-10}\r\n      />\r\n      <pointLight position={[0, -10, 0]} intensity={1.5} />\r\n    </>\r\n  )\r\n}\r\n","import * as THREE from 'three'\r\nimport React from 'react'\r\nimport { useLoader } from 'react-three-fiber'\r\nimport { usePlane } from 'use-cannon'\r\n\r\nimport Height from './height.png'\r\nimport Normal from './normal.png'\r\nimport Color from './color.png'\r\n\r\nexport const Ground = props => {\r\n  const mapWidth = 100, mapLength = 100\r\n  const vX = 1024\r\n\r\n  const [ref] = usePlane(() => ({\r\n    position: [0, 0, 0],\r\n    rotation: [-Math.PI / 2, 0, 0],\r\n    args: [mapWidth, mapLength, vX, vX],\r\n  }))\r\n\r\n  const H = useLoader(THREE.TextureLoader, Height)\r\n  const N = useLoader(THREE.TextureLoader, Normal)\r\n  const C= useLoader(THREE.TextureLoader, Color)\r\n\r\n  return (\r\n    <mesh ref={ref}>\r\n      <planeBufferGeometry args={[mapWidth, mapLength, vX, vX]} />\r\n      <meshStandardMaterial\r\n        attach=\"material\"\r\n        normalMap={N}\r\n        displacementMap={H}\r\n        map={C}\r\n        color=\"white\"\r\n      />\r\n    </mesh>\r\n  )\r\n}\r\n","import React, { useEffect, useRef, Suspense } from 'react'\r\nimport { PointerLockControls } from '@react-three/drei'\r\n\r\nimport * as THREE from 'three'\r\nimport { useSphere } from 'use-cannon'\r\nimport { useThree, useFrame } from 'react-three-fiber'\r\n\r\nimport { usePlayerControls } from './PlayerControls'\r\n\r\nexport const Player = props => {\r\n  const SPEED = 7\r\n  const PLAYER_HEIGHT = 2.5\r\n  const RUN_SPEED = SPEED * 1.5\r\n  const PAN_SPEED = SPEED * 0.5\r\n  const JUMP_HEIGHT = PLAYER_HEIGHT*3\r\n  const INERTIA = 5\r\n\r\n  const [ref, api] = useSphere(() => ({\r\n    mass: 1,\r\n    type: 'Dynamic',\r\n    position: [0, 10, 0],\r\n    ...props,\r\n  }))\r\n\r\n  const velocity = useRef([0, 0, 0])\r\n  const position = useRef([0, 0, 0])\r\n\r\n  const direction = new THREE.Vector3()\r\n  const frontVector = new THREE.Vector3()\r\n  const sideVector = new THREE.Vector3()\r\n\r\n  const camEuler = new THREE.Euler()\r\n\r\n  const { forward, backward, left, right, jump, run } = usePlayerControls()\r\n  const { camera } = useThree()\r\n\r\n  const playerOnGround = () => {\r\n    return position.current[1] < 1\r\n  }\r\n\r\n  const applyFriction = () => {\r\n    velocity.current[0] -= velocity.current[0] / INERTIA\r\n    velocity.current[2] -= velocity.current[2] / INERTIA\r\n  }\r\n\r\n  const calculateVelocity = () => {\r\n    frontVector.set(0, 0, backward - forward)\r\n    sideVector.set(left - right, 0, 0)\r\n    camEuler.set(0, 0, 0)\r\n\r\n    let FinalSpeed = SPEED\r\n\r\n    if (left || right) {\r\n      FinalSpeed = PAN_SPEED\r\n    } else if (run) {\r\n      FinalSpeed = RUN_SPEED\r\n    }\r\n\r\n    direction\r\n      .subVectors(frontVector, sideVector)\r\n      .normalize()\r\n      .multiplyScalar(FinalSpeed)\r\n      .applyEuler(camera.rotation)\r\n\r\n    applyFriction()\r\n\r\n    const v = [\r\n      velocity.current[0] + direction.x / INERTIA,\r\n      velocity.current[1],\r\n      velocity.current[2] + direction.z / INERTIA,\r\n    ]\r\n\r\n    if (playerOnGround()) {\r\n      api.velocity.set(v[0], v[1], v[2])\r\n\r\n      if (jump) api.velocity.set(v[0], JUMP_HEIGHT, v[2])\r\n    }\r\n  }\r\n\r\n  function moveCamera() {\r\n    const pos = ref.current.position\r\n\r\n    camera.position.y = pos.y + PLAYER_HEIGHT\r\n\r\n    camera.position.x = pos.x\r\n\r\n    camera.position.z = pos.z\r\n  }\r\n\r\n  useEffect(() => {\r\n    api.velocity.subscribe(v => (velocity.current = v))\r\n    api.position.subscribe(v => (position.current = v))\r\n  }, [])\r\n\r\n  useFrame(() => {\r\n    moveCamera()\r\n    calculateVelocity()\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <PointerLockControls />\r\n      <mesh ref={ref}></mesh>\r\n    </>\r\n  )\r\n}\r\n","import { useState, useEffect } from 'react'\r\n\r\nexport const usePlayerControls = () => {\r\n  const [movement, setMovement] = useState({\r\n    forward: false,\r\n    backward: false,\r\n    left: false,\r\n    right: false,\r\n    jump: false,\r\n    run: false,\r\n  })\r\n\r\n  const keys = {\r\n    KeyW: 'forward',\r\n    KeyS: 'backward',\r\n    KeyA: 'left',\r\n    KeyD: 'right',\r\n    Space: 'jump',\r\n    ShiftLeft: 'run',\r\n  }\r\n\r\n  const moveFieldByKey = key => keys[key]\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = e =>\r\n      setMovement(m => ({ ...m, [moveFieldByKey(e.code)]: true }))\r\n\r\n    const handleKeyUp = e =>\r\n      setMovement(m => ({ ...m, [moveFieldByKey(e.code)]: false }))\r\n\r\n    document.addEventListener('keydown', handleKeyDown)\r\n    document.addEventListener('keyup', handleKeyUp)\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown)\r\n      document.removeEventListener('keyup', handleKeyUp)\r\n    }\r\n  }, [])\r\n  return movement\r\n}\r\n","import { useState, useEffect } from \"react\"\r\nimport { addEffect, addAfterEffect } from \"react-three-fiber\"\r\n// @ts-ignore\r\nimport StatsImpl from \"stats.js\"\r\n\r\nexport function Stats({ showPanel = 0, className, parent }) {\r\n  const [stats] = useState(() => new StatsImpl())\r\n  useEffect(() => {\r\n    const node = (parent && parent.current) || document.body\r\n\r\n    stats.showPanel(showPanel)\r\n    node.appendChild(stats.dom)\r\n\r\n    if (className) stats.dom.classList.add(className)\r\n\r\n    const begin = addEffect(() => stats.begin())\r\n    const end = addAfterEffect(() => stats.end())\r\n\r\n    return () => {\r\n      node.removeChild(stats.dom)\r\n      begin()\r\n      end()\r\n    }\r\n  }, [parent])\r\n  return null\r\n}\r\n","import React, { Suspense } from 'react'\r\n\r\nimport { Canvas } from 'react-three-fiber'\r\nimport { Physics } from 'use-cannon'\r\n\r\nimport { Lighting } from './lighting/Lighting'\r\nimport { Ground } from './terrain/ground/Ground'\r\nimport { Player } from './player/Player'\r\nimport { Stats } from './player/hud/Stats'\r\n\r\nexport default function App() {\r\n  return (\r\n    <Canvas shadowMap gl={{ alpha: false }} camera={{ fov: 50 }}>\r\n      <Lighting />\r\n      <Stats />\r\n      <Physics gravity={[0, -10, 0]}>\r\n        <Player />\r\n        <Suspense fallback={null}>\r\n          <Ground />\r\n        </Suspense>\r\n      </Physics>\r\n    </Canvas>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport './App.css'\r\nimport App from './App'\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n"],"sourceRoot":""}