(this["webpackJsonpthree-fps"]=this["webpackJsonpthree-fps"]||[]).push([[0],{38:function(e,t,r){},40:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(29),c=r.n(o),i=(r(38),r(7)),l=r(41),u=r(45),m=r(43),s=function(e){return n.a.createElement(n.a.Fragment,null,e.day.current?n.a.createElement(n.a.Fragment,null,n.a.createElement(u.a,{distance:45e4,sunPosition:[1,1,0],inclination:0,azimuth:.25}),n.a.createElement("directionalLight",{position:[0,10,20],intensity:1,"shadow-camera-left":-20,"shadow-camera-bottom":-20,"shadow-camera-right":20,"shadow-camera-top":20,"shadow-camera-near":.1,"shadow-camera-far":1500,color:"white",castShadow:!0}),n.a.createElement("hemisphereLight",{skyColor:"black",groundColor:16777215,intensity:1,position:[0,50,0]})):n.a.createElement(n.a.Fragment,null,n.a.createElement(m.a,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0}),n.a.createElement("hemisphereLight",{skyColor:"black",groundColor:16777215,intensity:.03,position:[0,50,0]})))},d=r(12),h=r(5),p=r(1),f=Object(a.forwardRef)((function(e,t){var r=e.STATS,n=e.api,o=e.C,c=o.forward,l=o.backward,u=o.left,m=o.right,s=o.jump,d=o.run,h=(o.crouch,Object(a.useRef)([0,0,0])),f=Object(a.useRef)([0,0,0]),g=Object(a.useRef)(),b=new p.Vector3,y=new p.Vector3,E=new p.Vector3,v=new p.Euler,w=function(){y.set(0,0,l-c),E.set(u-m,0,0),v.set(0,0,0);var t=r.speed;u||m?t=r.pan_speed():d&&(t=r.run_speed()),b.subVectors(y,E).normalize().multiplyScalar(t).applyEuler(e.camera.rotation),h.current[0]-=h.current[0]/r.inertia,h.current[2]-=h.current[2]/r.inertia;var a=[h.current[0]+b.x/r.inertia,h.current[1],h.current[2]+b.z/r.inertia];f.current[1]<1&&(n.velocity.set(a[0],a[1],a[2]),s||(g.current=!1),s&&!g.current&&(g.current=!0,n.velocity.set(a[0],r.jump_height(),a[2])))};return Object(a.useEffect)((function(){n.velocity.subscribe((function(e){return h.current=e})),n.position.subscribe((function(e){return f.current=e}))}),[]),Object(i.d)((function(){w()})),null})),g=r(44),b=Object(a.forwardRef)((function(e,t){return Object(i.d)((function(){!function(){var r=t.current.position;e.camera.position.y=r.y+e.STATS.player_height,e.camera.position.x=r.x,e.camera.position.z=r.z}()})),n.a.createElement(g.a,null)})),y=r(6),E=Object(a.forwardRef)((function(e,t){var r=Object(a.useMemo)((function(){return new p.SpotLight("#f6d980")}),[]),o=Object(a.useRef)(!0),c=Object(a.useRef)(!0),l=e.C.toggle_light;return r.angle=.4,r.intensity=c.current?2:0,r.castShadow=!0,Object(i.d)((function(){l||(o.current=!0),l&&o.current&&(o.current=!1,c.current=!c.current),function(){var a=t.current.position;r.position.y=a.y+e.STATS.player_height,r.position.x=a.x,r.position.z=a.z}(),function(){var t=new p.Vector3;e.camera.getWorldDirection(t),t.multiplyScalar(2),t.add(e.camera.position),r.target.position.set(t.x,t.y,t.z),r.target.setRotationFromQuaternion(e.camera.quaternion)}()})),n.a.createElement(n.a.Fragment,null,n.a.createElement("primitive",{object:r,penumbra:!0}),n.a.createElement("primitive",{object:r.target,position:[0,2,0]}))}));function v(e){var t={speed:5,player_height:2.5,run_speed:function(){return 2*t.speed},pan_speed:function(){return.6*t.speed},jump_height:function(){return 3*t.player_height},inertia:5},r=Object(l.e)((function(){return Object(d.a)({mass:1,type:"Dynamic",position:[0,t.player_height,0],size:[1,32,32]},e)})),o=Object(h.a)(r,2),c=o[0],u=o[1],m=Object(i.f)().camera,s=function(){var e=Object(a.useState)({forward:!1,backward:!1,left:!1,right:!1,jump:!1,run:!1,crouch:!1,toggle_light:!1}),t=Object(h.a)(e,2),r=t[0],n=t[1],o={KeyW:"forward",KeyS:"backward",KeyA:"left",KeyD:"right",Space:"jump",ShiftLeft:"run",KeyC:"crouch",KeyF:"toggle_light"},c=function(e){return o[e]};return Object(a.useEffect)((function(){var e=function(e){return n((function(t){return Object(d.a)(Object(d.a)({},t),{},Object(y.a)({},c(e.code),!0))}))},t=function(e){return n((function(t){return Object(d.a)(Object(d.a)({},t),{},Object(y.a)({},c(e.code),!1))}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),r}(),p=s.forward,g=s.backward,v=s.left,w=s.right,_=s.jump,j=s.run,O=s.crouch,S=s.toggle_light;return n.a.createElement("group",null,n.a.createElement(b,{ref:c,STATS:t,camera:m,c:{crouch:O}}),n.a.createElement(E,{ref:c,STATS:t,camera:m,C:{toggle_light:S}}),n.a.createElement(f,{ref:c,api:u,STATS:t,camera:m,C:{forward:p,backward:g,left:v,right:w,jump:_,run:j,crouch:O}}))}var w=r(33),_=r.n(w);function j(e){var t=e.showPanel,r=void 0===t?0:t,n=e.className,o=e.parent,c=Object(a.useState)((function(){return new _.a})),l=Object(h.a)(c,1)[0];return Object(a.useEffect)((function(){var e=o&&o.current||document.body;l.showPanel(r),e.appendChild(l.dom),n&&l.dom.classList.add(n);var t=Object(i.c)((function(){return l.begin()})),a=Object(i.b)((function(){return l.end()}));return function(){e.removeChild(l.dom),t(),a()}}),[o]),null}var O=r.p+"static/media/dirt.c82951bd.png",S=r(9),M={rand_vect:function(){var e=2*Math.random()*Math.PI;return{x:Math.cos(e),y:Math.sin(e)}},dot_prod_grid:function(e,t,r,a){var n,o=e-r,c=t-a;return this.gradients[[r,a]]?n=this.gradients[[r,a]]:(n=this.rand_vect(),this.gradients[[r,a]]=n),o*n.x+c*n.y},smootherstep:function(e){return 6*Math.pow(e,5)-15*Math.pow(e,4)+10*Math.pow(e,3)},interp:function(e,t,r){return t+this.smootherstep(e)*(r-t)},seed:function(){this.gradients={}},memory:{},get:function(e,t){if(this.memory.hasOwnProperty([e,t]))return this.memory[[e,t]];var r=Math.floor(e),a=Math.floor(t),n=this.dot_prod_grid(e,t,r,a),o=this.dot_prod_grid(e,t,r+1,a),c=this.dot_prod_grid(e,t,r,a+1),i=this.dot_prod_grid(e,t,r+1,a+1),l=this.interp(e-r,n,o),u=this.interp(e-r,c,i),m=this.interp(t-a,l,u);return this.memory[[e,t]]=m,m}};M.seed();var k=r.p+"static/media/grass_blades.ab29baee.png";function C(e){var t=Object(a.useRef)(),r=Math.pow(300,2),o=Math.pow(r,.5)/2,c=.5,l=Object(a.useMemo)((function(){return{positions:Object(S.a)(Array(r)).map((function(){return new p.Vector3})),transform:new p.Matrix4}}),[]),u=l.positions,m=l.transform;Object(a.useLayoutEffect)((function(){for(var e=0,r=0,a=-o;a<o;a++)for(var n=-o;n<o;n++)r=1*M.get(.2*a,.2*n),u[e].set(a*c+Math.random()*c,r,n*c+Math.random()*c),m.setPosition(u[e]),t.current.setMatrixAt(e,m),e++}),[]);for(var s=new p.PlaneBufferGeometry(2,2),d=s.attributes.position,h=0;h<d.count;h++){var f=d.getX(h),g=d.getY(h),b=d.getZ(h);d.setXYZ(h,f,g,b)}var y=Object(i.e)(p.TextureLoader,k);return n.a.createElement("group",e,n.a.createElement("instancedMesh",{args:[s,null,r],ref:t},n.a.createElement("meshLambertMaterial",{side:p.DoubleSide,alphaTest:.5,transparent:!0,opacity:1,map:y})))}function T(e){return n.a.createElement(a.Suspense,{fallback:null},n.a.createElement("group",e,n.a.createElement(C,{rotation:[0,1*Math.PI/4,0]}),n.a.createElement(C,{rotation:[0,2*Math.PI/4,0]}),n.a.createElement(C,{rotation:[0,3*Math.PI/4,0]}),n.a.createElement(C,{rotation:[0,4*Math.PI/4,0]})))}var P=function(e){var t=1e3,r=1e3,a=500,o=Object(l.f)((function(){return{position:[0,0,0],rotation:[-Math.PI/2,0,0],args:[t,r,a,a]}})),c=Object(h.a)(o,1)[0],u=Object(i.e)(p.TextureLoader,O);return u.wrapS=u.wrapT=p.RepeatWrapping,u.repeat.set(250,250),n.a.createElement(n.a.Fragment,null,n.a.createElement(T,{position:[0,1,0]}),n.a.createElement("mesh",{ref:c,receiveShadow:!0},n.a.createElement("planeBufferGeometry",{attach:"geometry",args:[t,r,a,a]}),n.a.createElement("meshStandardMaterial",{attach:"material",map:u})))},L=r(16);function x(e){var t=Object(a.useRef)(!1),r=Object(l.c)((function(){return Object(d.a)({mass:0,args:[1.5,20,1.5]},e)})),o=Object(h.a)(r,1)[0],c=Object(L.a)("/three-fps/models/trees/tree03/scene.gltf"),i=c.nodes,u=c.materials;return n.a.createElement("mesh",{ref:o,scale:e.scale,dispose:null},t.current?n.a.createElement(n.a.Fragment,null,n.a.createElement("boxBufferGeometry",{attach:"geometry",args:[1.5/e.scale[0],20/e.scale[1],1.5/e.scale[2]]}),n.a.createElement("meshLambertMaterial",{color:"red",opacity:.7,transparent:!0})):null,n.a.createElement(a.Suspense,{fallback:null},n.a.createElement("group",{dispose:null},n.a.createElement("group",{rotation:[-Math.PI/2,0,0]},n.a.createElement("group",{rotation:[Math.PI/2,0,0]},n.a.createElement("mesh",{material:u.Mat_pine_tree_bark_lambert3,geometry:i.tree_Mat_pine_tree_bark_lambert3_0.geometry,alphaTest:.5}),e.dead?null:n.a.createElement("mesh",{material:u.Mat_pine_tree_branch_lambert2,geometry:i.group47_Mat_pine_tree_branch_lambert2_0.geometry,alphaTest:.5}))))))}function R(){return function(e,t,r,a,o,c){for(var i=Math.floor(e/2),l=[],u=1;u<e-1;u++){l[u]=[];for(var m=1;m<e-1;m++){var s=u-i,d=m-i;if(1*Math.round(Math.random())&&(s>t/2||s<t/-2)||d>t/2||d<t/-2){var h=Math.random()*a+r,p=Math.random()*c+o,f=Math.round(15*Math.random()+1)<3;l[u][m]={active:1,scale:[p,p,p],position:[s*h,0,d*h],dead:f}}else l[u][m]={}}}for(var g=[],b=1;b<e-1;b++)for(var y=1;y<e-1;y++)l[b][y].active&&g.push(n.a.createElement(n.a.Fragment,null,n.a.createElement(x,{key:"".concat(b).concat(y),position:l[b][y].position,scale:l[b][y].scale,dead:l[b][y].dead})));return g}(15,1,10,15,.01,.05)}function I(e){var t=Object(a.useRef)(!1),r=Object(l.c)((function(){return Object(d.a)({mass:0,args:[12,10,1]},e)})),o=Object(h.a)(r,1)[0],c=Object(L.a)("/three-fps/models/objects/fence01/scene.gltf"),i=c.nodes,u=c.materials;return n.a.createElement("mesh",{ref:o,scale:e.scale,dispose:null},t.current?n.a.createElement(n.a.Fragment,null,n.a.createElement("boxBufferGeometry",{attach:"geometry",args:[12/e.scale[0],10/e.scale[1],1/e.scale[2]]}),n.a.createElement("meshLambertMaterial",{color:"red",opacity:.7,transparent:!0})):null,n.a.createElement(a.Suspense,{fallback:null},n.a.createElement("group",{rotation:[-Math.PI/2,0,0]},n.a.createElement("group",{rotation:[Math.PI/2,0,0]},n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder10_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder11_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder6_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder15_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder12_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder13_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder8_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder9_lambert1_0.geometry}),n.a.createElement("mesh",{receiveShadow:!0,castShadow:!0,material:u.lambert1,geometry:i.pCylinder5_lambert1_0.geometry})))))}L.a.preload("/three-fps/models/trees/tree03/scene.gltf"),L.a.preload("/three-fps/models/objects/fence01/scene.gltf");var F=function(e,t,r,a){for(var o=[],c=0;c<a;c++){var i=e?r/2:r,l=e?r/2+r*c:r*c,u=void 0;e&&(u=i,i=l,l=u),o.push(n.a.createElement(I,{scale:[.5,.5,.5],position:[t[0]+i,t[1],t[2]+l],rotation:[0,e?0:Math.PI/2,0]}))}return o};function z(){var e=10,t=-60;return n.a.createElement("group",null,n.a.createElement("group",null,F(!0,[t,0,-72],12,e)),n.a.createElement("group",null,F(!1,[-72,0,t],12,e)),n.a.createElement("group",null,F(!0,[t,0,48],12,e)),n.a.createElement("group",null,F(!1,[48,0,t],12,e)))}function A(){return n.a.createElement("group",null,n.a.createElement(R,null),n.a.createElement(z,null),n.a.createElement(P,null))}function K(){console.warn=function(){};var e=Object(a.useRef)(!0);return n.a.createElement(i.a,{shadowMap:!0,gl:{alpha:!1},camera:{fov:60}},n.a.createElement(s,{day:e}),e.current?null:n.a.createElement("fog",{attach:"fog",args:["black",10,100]}),n.a.createElement(j,null),n.a.createElement(l.a,{gravity:[0,-10,0]},n.a.createElement(v,null),n.a.createElement(A,null)))}c.a.render(n.a.createElement(K,null),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.eb2ae14a.chunk.js.map